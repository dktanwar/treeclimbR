<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Simulate a count table — .doData • treeclimbR</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Simulate a count table — .doData" />
<meta property="og:description" content=".doData creates a count table for all nodes of a tree under two
different groups such that the tree would have different abundance patterns
in the different conditions." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">treeclimbR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Simulate a count table</h1>
    
    <div class="hidden name"><code>dot-doData.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>.doData</code> creates a count table for all nodes of a tree under two
different groups such that the tree would have different abundance patterns
in the different conditions.</p>
    </div>

    <pre class="usage"><span class='fu'><a href='https://rdrr.io/pkg/treeclimbR/man/dot-doData.html'>.doData</a></span>(
  tree = <span class='kw'>NULL</span>,
  data = <span class='kw'>NULL</span>,
  scenario = <span class='st'>"BS"</span>,
  from.A = <span class='kw'>NULL</span>,
  from.B = <span class='kw'>NULL</span>,
  minTip.A = <span class='fl'>0</span>,
  maxTip.A = <span class='fl'>Inf</span>,
  minTip.B = <span class='fl'>0</span>,
  maxTip.B = <span class='fl'>Inf</span>,
  minPr.A = <span class='fl'>0</span>,
  maxPr.A = <span class='fl'>1</span>,
  ratio = <span class='fl'>2</span>,
  adjB = <span class='kw'>NULL</span>,
  pct = <span class='fl'>0.6</span>,
  nSam = <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>50</span>, <span class='fl'>50</span>),
  mu = <span class='fl'>50</span>,
  size = <span class='fl'>10000</span>,
  n = <span class='fl'>1</span>,
  FUN = <span class='kw'>sum</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>tree</th>
      <td><p>A phylo object</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>A matrix, representing a count table from real data. It has the
entities corresponding to tree leaves in the row and samples in the column.</p></td>
    </tr>
    <tr>
      <th>scenario</th>
      <td><p>&#8220;BS&#8221;, &#8220;US&#8221;, or &#8220;SS&#8221; (see
<b>Details</b>). Default is &#8220;BS&#8221;.</p></td>
    </tr>
    <tr>
      <th>from.A, from.B</th>
      <td><p>The branch node labels of branches A and B for which the
signal is swapped. Default, both are NULL. In simulation, we select two
branches (A &amp; B) to have differential abundance under different conditions.
One could specify these two branches or let <code>.doData</code> choose. (Note: If
<code>from.A</code> is NULL, <code>from.B</code> is set to NULL).</p></td>
    </tr>
    <tr>
      <th>minTip.A</th>
      <td><p>The minimum number of leaves in branch A</p></td>
    </tr>
    <tr>
      <th>maxTip.A</th>
      <td><p>The maximum number of leaves in branch A</p></td>
    </tr>
    <tr>
      <th>minTip.B</th>
      <td><p>The minimum number of leaves in branch B</p></td>
    </tr>
    <tr>
      <th>maxTip.B</th>
      <td><p>The maximum number of leaves in branch B</p></td>
    </tr>
    <tr>
      <th>minPr.A</th>
      <td><p>A numeric value selected from 0 to 1. The minimum abundance
proportion of leaves in branch A</p></td>
    </tr>
    <tr>
      <th>maxPr.A</th>
      <td><p>A numeric value selected from 0 to 1.The maximum abundance
proportion of leaves in branch A</p></td>
    </tr>
    <tr>
      <th>ratio</th>
      <td><p>The proportion ratio of branch B to branch A. This value is used
to select branches(see <b>Details</b>). If there are no branches having
exactly this ratio, the pair with the value closest to <code>ratio</code> would
be selected.</p></td>
    </tr>
    <tr>
      <th>adjB</th>
      <td><p>a numeric value selected from 0 and 1 (only for <code>scenario</code>
is &#8220;SS&#8221;). Default is NULL. If NULL, branch A and branch B swap their
proportions. If a numeric value, e.g. 0.1, then branch B decreases to its
one tenth proportion and the decrease in branch B is added to branch A. For
example, assume there are two experimental conditions (C1 &amp; C2), branch A
has 10 and branch B has 40 in C1. If adjB is set to 0.1, then in C2 branch
B becomes 4 and branch A 46 so that the total proportion stays the same.</p></td>
    </tr>
    <tr>
      <th>pct</th>
      <td><p>a numeric value selected from 0 and 1. The percentage of leaves in
branch B that have differential abundance under different conditions (only
for scenario &#8220;SS&#8221;)</p></td>
    </tr>
    <tr>
      <th>nSam</th>
      <td><p>A numeric vector of length 2, containing the sample size for two
different conditions</p></td>
    </tr>
    <tr>
      <th>mu, size</th>
      <td><p>The parameters of the Negative Binomial distribution. (see mu
and size in <code><a href='https://rdrr.io/r/stats/NegBinomial.html'>rnbinom</a></code>). Parameters used to
generate the library size for each simulated sample.</p></td>
    </tr>
    <tr>
      <th>n</th>
      <td><p>A numeric value to specify how many count tables would be generated
with the same settings. Default is one and one count table would be
obtained at the end. If above one, the output of <code>.doData</code> is a list of
matrices (count tables). This is useful, when one needs multiple
simulations.</p></td>
    </tr>
    <tr>
      <th>FUN</th>
      <td><p>A function to derive the count at each internal node based on its
descendant leaves, e.g. sum, mean. The argument of the function is a
numeric vector with the counts of an internal node's descendant leaves.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a list of objects</p>
<dt>FC</dt><dd><p>the fold change of entities correspondint
  to the tree leaves.</p></dd> <dt>Count</dt><dd><p>a list of count table or a count table.
  Entities on the row and samples in the column. Each count table includes
  entities corresponding to all nodes on the tree structure.</p></dd>
  <dt>Branch</dt><dd><p>the information about two selected branches.</p></dd> 
         

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><code>.doData</code> simulates a count table for entities which are
  corresponding to the nodes of a tree. The entities are in rows and the
  samples from different groups or conditions are in columns. The library
  size of each sample is sampled from a Negative Binomial distribution with
  mean and size specified by the arguments <code>mu</code> and <code>size</code>. The
  counts of entities, which are located on the tree leaves, in the same
  sample are assumed to follow a Dirichlet-Multinomial distribution. The
  parameters for the Dirichlet-Multinomial distribution are estimated from a
  real data set specified by the argument <code>data</code> via the function
  <code>dirmult</code> (see <code><a href='https://rdrr.io/pkg/dirmult/man/dirmult.html'>dirmult</a></code>). To generate different
  abundance patterns under different conditions, we provide three different
  scenarios, &#8220;BS&#8221;, &#8220;US&#8221;, and &#8220;SS&#8221; (specified via
  <code>scenario</code>).</p><ul>
<li><p>BS: two branches are selected to swap
  their proportions, and leaves on the same branch have the same fold change.</p></li>
<li><p>US: two branches are selected to swap their proportions. Leaves in
  the same branch have different fold changes but same direction (either
  increase or decrease).</p></li>
<li><p>SS: two branches are selected. One branch has
  its proportion swapped with the proportion of some leaves from the other
  branch.</p></li>
</ul>

    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Ruizhu Huang</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>if</span> (<span class='fl'>FALSE</span>) {
<span class='co'>if</span>(<span class='fu'><a href='https://rdrr.io/r/base/library.html'>require</a></span>(<span class='kw'>GUniFrac</span>)){
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='st'>"throat.otu.tab"</span>)
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='st'>"throat.tree"</span>)

<span class='kw'>dat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/treeclimbR/man/dot-doData.html'>.doData</a></span>(tree = <span class='kw'>throat.tree</span>,
data = <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span>(<span class='kw'>throat.otu.tab</span>)),
ratio = <span class='fl'>2</span>)
}
}</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Ruizhu Huang.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


