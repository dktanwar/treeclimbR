<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Test for differential state using edgeR — runDS • treeclimbR</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Test for differential state using edgeR — runDS" />
<meta property="og:description" content="runDA tests differential state of entities using functions from the
edgeR. This adapts edgerWrp to accept input as a
SummarizedExperiment (SE) object
instead of matrix. To clarify, the count table is stored in the
assays table of SE object. Each matrix in assays
stores data corresponding to a node of the tree. Samples are in columns and
features, e.g., genes or antibodies, are in rows. The sample information is
in colData. The tree that stores the hierarchical information about
the assays is provided via the argument tree. assays are
named with the alias labels of nodes that could be mapped to the provided
tree. The experimental design is specified by a design matrix and provide to
model via the argument design. Alternatively, users could specify the
name of columns (from colData) that are passed to
model.matrix to generate the design matrix." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">treeclimbR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Test for differential state using edgeR</h1>
    
    <div class="hidden name"><code>runDS.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>runDA</code> tests differential state of entities using functions from the
<code>edgeR</code>. This adapts <code><a href='https://rdrr.io/pkg/treeclimbR/man/edgerWrp.html'>edgerWrp</a></code> to accept input as a
<code><a href='https://rdrr.io/pkg/SummarizedExperiment/man/RangedSummarizedExperiment-class.html'>SummarizedExperiment</a></code> (<strong>SE</strong>) object
instead of <code>matrix</code>. To clarify, the count table is stored in the
<code>assays</code> table of <strong>SE</strong> object. Each matrix in <code>assays</code>
stores data corresponding to a node of the tree. Samples are in columns and
features, e.g., genes or antibodies, are in rows. The sample information is
in <code>colData</code>. The tree that stores the hierarchical information about
the <code>assays</code> is provided via the argument <code>tree</code>. <code>assays</code> are
named with the alias labels of nodes that could be mapped to the provided
tree. The experimental design is specified by a design matrix and provide to
model via the argument <code>design</code>. Alternatively, users could specify the
name of columns (from <code>colData</code>) that are passed to
<code><a href='https://rdrr.io/r/stats/model.matrix.html'>model.matrix</a></code> to generate the design matrix.</p>
    </div>

    <pre class="usage"><span class='fu'><a href='https://rdrr.io/pkg/treeclimbR/man/runDS.html'>runDS</a></span>(
  <span class='kw'>SE</span>,
  <span class='kw'>tree</span>,
  option = <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"glm"</span>, <span class='st'>"glmQL"</span>),
  design = <span class='kw'>NULL</span>,
  contrast = <span class='kw'>NULL</span>,
  filter_min_count = <span class='fl'>1</span>,
  filter_min_total_count = <span class='fl'>15</span>,
  filter_large_n = <span class='fl'>10</span>,
  filter_min_prop = <span class='fl'>1</span>,
  min_cells = <span class='fl'>10</span>,
  normalize = <span class='fl'>TRUE</span>,
  normalize_method = <span class='st'>"TMM"</span>,
  group_column = <span class='st'>"group_id"</span>,
  design_terms = <span class='st'>"group_id"</span>,
  message = <span class='fl'>TRUE</span>,
  <span class='kw'>...</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>SE</th>
      <td><p>A SummarizedExperiment object.</p></td>
    </tr>
    <tr>
      <th>tree</th>
      <td><p>A phylo object. Each matrix in <strong>assays</strong> (of <code>SE</code>)
stores data on one node of the tree.</p></td>
    </tr>
    <tr>
      <th>option</th>
      <td><p><code>"glm"</code> or <code>"glmQL"</code>. If <code>"glm"</code>,
<code><a href='https://rdrr.io/pkg/edgeR/man/glmfit.html'>glmFit</a></code> and <code><a href='https://rdrr.io/pkg/edgeR/man/glmfit.html'>glmLRT</a></code> are used;
otherwise, <code><a href='https://rdrr.io/pkg/edgeR/man/glmQLFTest.html'>glmQLFit</a></code> and
<code><a href='https://rdrr.io/pkg/edgeR/man/glmQLFTest.html'>glmQLFTest</a></code> are used. Details about the difference
between two options are in the help page of <code><a href='https://rdrr.io/pkg/edgeR/man/glmQLFTest.html'>glmQLFit</a></code>.</p></td>
    </tr>
    <tr>
      <th>design</th>
      <td><p>A numeric matrix. It must be of full column rank. Defaults to
use all columns of sample annotation data to create the design matrix. The
sample annotation data is stored in the <code>colData</code> of <code>tse</code> when
<code>onRow = TRUE</code>; otherwise it is in the <code>rowData</code>. Note: Users
should check whether the default created design matrix is exactly what they
want or create their own design matrix using
<code><a href='https://rdrr.io/r/stats/model.matrix.html'>model.matrix</a></code>.</p></td>
    </tr>
    <tr>
      <th>contrast</th>
      <td><p>A numeric vector specifying one contrast of
the linear model coefficients to be tested equal to zero. Its length
must equal to the number of columns of design. If NULL, the last
coefficient will be tested equal to zero.</p></td>
    </tr>
    <tr>
      <th>filter_min_count</th>
      <td><p>A numeric value. It's passed to <strong>min.count</strong> of
<code><a href='https://rdrr.io/pkg/edgeR/man/filterByExpr.html'>filterByExpr</a></code>.</p></td>
    </tr>
    <tr>
      <th>filter_min_total_count</th>
      <td><p>A numeric value. It's passed to
<strong>min.total.count</strong> of <code><a href='https://rdrr.io/pkg/edgeR/man/filterByExpr.html'>filterByExpr</a></code>.</p></td>
    </tr>
    <tr>
      <th>filter_large_n</th>
      <td><p>A numeric value. It's passed to <strong>large.n</strong> of
<code><a href='https://rdrr.io/pkg/edgeR/man/filterByExpr.html'>filterByExpr</a></code>.</p></td>
    </tr>
    <tr>
      <th>filter_min_prop</th>
      <td><p>A numeric value. It's passed to <strong>min.prop</strong> of
<code><a href='https://rdrr.io/pkg/edgeR/man/filterByExpr.html'>filterByExpr</a></code>.</p></td>
    </tr>
    <tr>
      <th>min_cells</th>
      <td><p>A numeric value. The minimum number of cells in a node to
include a node in the analysis.</p></td>
    </tr>
    <tr>
      <th>normalize</th>
      <td><p>A logical value, TRUE or FALSE. The default is TRUE.</p></td>
    </tr>
    <tr>
      <th>normalize_method</th>
      <td><p>Normalization method to be used. See
<code><a href='https://rdrr.io/pkg/edgeR/man/calcNormFactors.html'>calcNormFactors</a></code> for more details.
It could be "bonferroni", "holm", "hochberg", "hommel", "BH", or "BY". This
is passed to <code>adjust.method</code> of <code><a href='https://rdrr.io/pkg/edgeR/man/topTags.html'>topTags</a></code></p></td>
    </tr>
    <tr>
      <th>group_column</th>
      <td><p>The column name of group</p></td>
    </tr>
    <tr>
      <th>design_terms</th>
      <td><p>The names of columns from <code>colData</code> (if samples in
columns) that are used to generate design matrix. This is ignored if
<strong>design</strong> is provided.</p></td>
    </tr>
    <tr>
      <th>message</th>
      <td><p>A logical value, TRUE or FALSE. If TRUE, the running process
is printed out.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>More arguments to pass to <code><a href='https://rdrr.io/pkg/edgeR/man/glmfit.html'>glmFit</a></code>
(<code>option = "glm"</code> or <code><a href='https://rdrr.io/pkg/edgeR/man/glmQLFTest.html'>glmQLFit</a></code> (<code>option =
"glmQL"</code>).</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a list includes <strong>edgeR_results</strong>, <strong>tree</strong>, and
  <strong>nodes_drop</strong>.</p><dl>
  <dt>edgeR_results</dt><dd><p>A list, each of its element is the output of
  <code><a href='https://rdrr.io/pkg/edgeR/man/glmQLFTest.html'>glmQLFTest</a></code> or <code><a href='https://rdrr.io/pkg/edgeR/man/glmfit.html'>glmLRT</a></code> depends on
  the specified <code>option</code>. The list is named by the alias label of nodes</p></dd>
  <dt>tree</dt><dd><p>The hiearchical structure of entities that was stored in the
     input <code>tse</code></p></dd>
  <dt>nodes_drop</dt><dd><p>A vector storing the alias node labels of entities. 
     These nodes have no sufficient data to run analysis.</p></dd>

</dl>

    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Ruizhu Huang</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='kw'>TreeSummarizedExperiment</span>)

<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='kw'>tinyTree</span>)

<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>1</span>)
<span class='co'># data: genes in rows, cells in columns</span>
<span class='kw'>ncell</span> <span class='op'>&lt;-</span> <span class='fl'>500</span>
<span class='kw'>ngene</span> <span class='op'>&lt;-</span> <span class='fl'>20</span>
<span class='kw'>dat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Poisson.html'>rpois</a></span>(<span class='kw'>ngene</span><span class='op'>*</span><span class='kw'>ncell</span>, lambda = <span class='fl'>20</span>), nrow = <span class='kw'>ngene</span>)

<span class='co'># cells belong to different clusters</span>
<span class='kw'>clus</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span>(<span class='kw'>tinyTree</span><span class='op'>$</span><span class='kw'>tip.label</span>, <span class='fl'>500</span>, replace = <span class='fl'>TRUE</span>)
<span class='kw'>sid</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span>(<span class='fl'>1</span><span class='op'>:</span><span class='fl'>4</span>, <span class='fl'>500</span>, replace = <span class='fl'>TRUE</span>)
<span class='kw'>gid</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span>(<span class='kw'>sid</span> <span class='op'>%in%</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>2</span>, <span class='st'>"A"</span>, <span class='st'>"B"</span>)
<span class='kw'>colD</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>(cluster_id = <span class='kw'>clus</span>,
                   sample_id = <span class='kw'>sid</span>,
                   group = <span class='kw'>gid</span>,
                   stringsAsFactors = <span class='fl'>FALSE</span>)
<span class='co'># TreeSummarizedExperiment object</span>
<span class='kw'>d_tse</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/TreeSummarizedExperiment/man/TreeSummarizedExperiment-constructor.html'>TreeSummarizedExperiment</a></span>(
            assays = <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>dat</span>),
            colData = <span class='kw'>colD</span>,
            colTree = <span class='kw'>tinyTree</span>, 
            colNodeLab = <span class='kw'>clus</span>)
<span class='kw'>d_se</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/treeclimbR/man/aggDS.html'>aggDS</a></span>(TSE = <span class='kw'>d_tse</span>, 
              assay = <span class='fl'>1</span>, sample_id = <span class='st'>"sample_id"</span>,
              group_id = <span class='st'>"group"</span>,
              cluster_id = <span class='st'>"cluster_id"</span>, FUN = <span class='kw'>sum</span>)</div><div class='output co'>#&gt; <span class='error'>Error in showNode(tree = tree, only.leaf = FALSE, use.alias = TRUE): could not find function "showNode"</span></div><div class='input'>
<span class='kw'>res</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/treeclimbR/man/runDS.html'>runDS</a></span>(SE = <span class='kw'>d_se</span>, tree = <span class='kw'>tinyTree</span>, 
             option = <span class='st'>"glm"</span>, group_column = <span class='st'>"group"</span>,
             design_terms = <span class='st'>"group"</span>)</div><div class='output co'>#&gt; <span class='error'>Error in h(simpleError(msg, call)): error in evaluating the argument 'x' in selecting a method for function 'assays': object 'd_se' not found</span></div><div class='input'><span class='fu'><a href='https://rdrr.io/pkg/treeclimbR/man/nodeResult.html'>nodeResult</a></span>(<span class='kw'>res</span>, type = <span class='st'>"DS"</span>)</div><div class='output co'>#&gt; <span class='error'>Error in nodeResult(res, type = "DS"): object 'res' not found</span></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Ruizhu Huang.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


